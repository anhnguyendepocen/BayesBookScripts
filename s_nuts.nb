(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66316,       1621]
NotebookOptionsPosition[     65345,       1585]
NotebookOutlinePosition[     65708,       1601]
CellTagsIndexPosition[     65665,       1598]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.752238819415077*^9, 3.752238826229746*^9}, {
  3.752239964338439*^9, 3.752239964499198*^9}, {3.752246926696396*^9, 
  3.7522469269579763`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x__", "]"}], ":=", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.5", ",", "0.25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.25", ",", "1.5"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "x", "}"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fDerivative", "[", 
   RowBox[{"f_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Length", "[", "z", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "@@", "v"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"v", "\[Rule]", "z"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fLeapFrogStep", "[", 
   RowBox[{"\[Theta]_", ",", "m_", ",", "\[Epsilon]_", ",", "logP_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"grad", ",", "x", ",", "\[Theta]1", ",", "m1", ",", "grad1"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"grad", "=", 
      RowBox[{"fDerivative", "[", 
       RowBox[{"logP", ",", "\[Theta]"}], "]"}]}], ";", 
     RowBox[{"m1", "=", 
      RowBox[{"m", "+", 
       RowBox[{"0.5", " ", "\[Epsilon]", " ", "grad"}]}]}], ";", " ", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{"\[Epsilon]", " ", "m1"}]}]}], ";", 
     RowBox[{"grad1", "=", 
      RowBox[{"fDerivative", "[", 
       RowBox[{"logP", ",", "\[Theta]1"}], "]"}]}], ";", 
     RowBox[{"m1", "=", 
      RowBox[{"m1", "+", 
       RowBox[{"0.5", " ", "\[Epsilon]", " ", "grad1"}]}]}], ";", 
     RowBox[{"{", 
      RowBox[{"\[Theta]1", ",", "m1"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fBuildTree", "[", 
   RowBox[{
   "\[Theta]_", ",", "m_", ",", "u_", ",", "v_", ",", "j_", ",", 
    "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Cprimed", ",", "Cprimedprimed", ",", "sprimed", ",", "sprimedprimed", 
      ",", "res", ",", "thetaMinus", ",", "thetaPlus", ",", "mMinus", ",", 
      "mPlus", ",", "temp1", ",", "temp2"}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"res", "=", 
        RowBox[{"fLeapFrogStep", "[", 
         RowBox[{"\[Theta]", ",", "m", ",", 
          RowBox[{"v", " ", "\[Epsilon]"}], ",", "logP"}], "]"}]}], ";", 
       RowBox[{"Cprimed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "u", "]"}], "\[LessEqual]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logP", "[", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"m", ".", "m"}]}]}], ")"}]}], ",", "res", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", 
       RowBox[{"sprimed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "u", "]"}], "<", 
           RowBox[{"(", 
            RowBox[{"\[CapitalDelta]", "+", 
             RowBox[{"logP", "[", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"m", ".", "m"}]}]}], ")"}]}], ",", "1", ",", "0"}], 
         "]"}]}], ";", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "Cprimed", ",", "sprimed"}], 
        "}"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "thetaPlus", ",", "mPlus", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{"\[Theta]", ",", "m", ",", "u", ",", "v", ",", 
          RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
          "\[CapitalDelta]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"v", "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
            "Cprimedprimed", ",", "sprimedprimed"}], "}"}], "=", 
          RowBox[{"fBuildTree", "[", 
           RowBox[{"thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", 
            RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
            "\[CapitalDelta]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
            "Cprimedprimed", ",", "sprimedprimed"}], "}"}], "=", 
          RowBox[{"fBuildTree", "[", 
           RowBox[{"thetaPlus", ",", "mMinus", ",", "u", ",", "v", ",", 
            RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
            "\[CapitalDelta]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"sprimed", "=", 
        RowBox[{"sprimed", " ", "sprimedprimed", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
             "mMinus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
           "0"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mPlus"}],
             " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], 
          "]"}]}]}], ";", 
       RowBox[{"Cprimed", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"{", "Cprimed", "}"}], ",", 
          RowBox[{"{", "Cprimedprimed", "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"{", 
        RowBox[{
        "thetaMinus", ",", "mMinus", ",", "thetaPlus", ",", "mPlus", ",", 
         "Cprimed", ",", "sprimed"}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstep", "[", 
   RowBox[{
   "\[Theta]_", ",", "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetaMinus", "=", "\[Theta]"}], ",", 
      RowBox[{"thetaPlus", "=", "\[Theta]"}], ",", "mMinus", ",", "mPlus", 
      ",", 
      RowBox[{"j", "=", "0"}], ",", "C", ",", 
      RowBox[{"s", "=", "1"}], ",", "m", ",", "temp1", ",", "temp2", ",", 
      "Cprimed", ",", "sprimed", ",", "u", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "@", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "@", "\[Theta]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"UniformDistribution", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"logP", "[", "\[Theta]", "]"}], "-", 
              RowBox[{"0.5", " ", 
               RowBox[{"m", ".", "m"}]}]}], "]"}]}], "}"}], "]"}], ",", "1"}],
         "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mMinus", "=", "m"}], ";", 
     RowBox[{"mPlus", "=", "m"}], ";", 
     RowBox[{"C", "=", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "m"}], "}"}]}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"s", "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"RandomChoice", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"v", "\[Equal]", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
             "Cprimed", ",", "sprimed"}], "}"}], "=", 
           RowBox[{"fBuildTree", "[", 
            RowBox[{
            "thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", "j", ",", 
             "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
             "Cprimed", ",", "sprimed"}], "}"}], "=", 
           RowBox[{"fBuildTree", "[", 
            RowBox[{
            "thetaPlus", ",", "mPlus", ",", "u", ",", "v", ",", "j", ",", 
             "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sprimed", "\[Equal]", "1"}], ",", 
          RowBox[{"C", "=", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"{", "C", "}"}], ",", 
             RowBox[{"{", "Cprimed", "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{"sprimed", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
              "mMinus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
            "0"}], "]"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
              "mPlus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
            "0"}], "]"}]}]}], ";", 
        RowBox[{"j", " ", "=", " ", 
         RowBox[{"j", " ", "+", " ", "1"}]}]}]}], "]"}], ";", "C"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstepExtract", "[", "c_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dep", "=", 
      RowBox[{"Depth", "@", "c"}]}], "}"}], ",", 
    RowBox[{"RandomChoice", "@", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"c", ",", 
         RowBox[{"dep", "-", "4"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstepComplete", "[", 
   RowBox[{
   "\[Theta]_", ",", "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "=", 
      RowBox[{"fNUTSstep", "[", 
       RowBox[{
       "\[Theta]", ",", "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"fNUTSstepExtract", "[", "c", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTS", "[", 
   RowBox[{
   "M_Integer", ",", "\[Theta]0_", ",", "\[Epsilon]_", ",", "logP_", ",", 
    "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fNUTSstepComplete", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Epsilon]", ",", "logP", ",", 
       "\[CapitalDelta]"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]0", ",", 
      RowBox[{"{", "}"}]}], "}"}], ",", "M"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.752241656626203*^9, 3.752241701486404*^9}, {
   3.7522417374734*^9, 3.752241828537655*^9}, {3.752241868186348*^9, 
   3.7522418879097*^9}, {3.7522419918601017`*^9, 3.752242187343792*^9}, {
   3.7522422198022842`*^9, 3.752242223177862*^9}, {3.752242261379641*^9, 
   3.752242497584846*^9}, {3.752242537963459*^9, 3.7522425493917522`*^9}, {
   3.752242585883156*^9, 3.7522426865105333`*^9}, {3.752242723633382*^9, 
   3.7522428295423803`*^9}, 3.752242860112129*^9, {3.7522429132236443`*^9, 
   3.752243078848131*^9}, {3.752244128999853*^9, 3.7522441343109007`*^9}, {
   3.7522469086878147`*^9, 3.752246915785604*^9}, {3.752247355933969*^9, 
   3.752247381790059*^9}, {3.75224824179998*^9, 3.7522482454229517`*^9}, {
   3.752252301841056*^9, 3.7522523054725847`*^9}, {3.7522539322677402`*^9, 
   3.752253948299914*^9}, 3.752254479593254*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"samples", "=", 
   RowBox[{"fNUTS", "[", 
    RowBox[{"50", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "0.1", ",", "f", ",", "1000"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.752246461818357*^9, 3.75224647383322*^9}, 
   3.752246503892144*^9, 3.7522465378697*^9, {3.7522474117164583`*^9, 
   3.7522474352935667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"samples", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.752246488356022*^9, 3.752246492579344*^9}, {
  3.752246960008864*^9, 3.752246961343184*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.016666666666666666`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxlh3lMUwcAh0vpbJXa6x3t6xsi2Zx0OqsylJXj/VrchoIExY1B1EoDY5uw
deogFsrVbRkq4NVqdEqGIVwKDGRoIRKcIGpB55UwIKm1GNx0HiiozWDzX/2S
L1++YNM3azP4PB4v9H9f9lWiSzTkmpOeroVE98PK7AdcI8/anFbv7tonDVvt
pJ5yvUse7nwkHOaS2ax4WT2Nlt3hl3bon3NjeSfZsVwZfu7fk7+hT4Zd1tHg
hRYVCsMmW3jTBNLKLqw3aQIgqhrylG9WoCzMvTTltggrvEOJ/Q4C5w+HJNn5
YsT5d34S0kpiZ2NDDtkhxvL37sXHZUrQ/LGWKIwiEFyUMa5xypGqG8kw1skw
49ZpViKRQ71p2eLQcvlrP2ZtrIu2qWCPudP8yygFMyVj/olmEDD8/uwYAQHi
wBTzQkdh6NDNRcxRCZrub9SbXDRSh6ad2e0SCERWjc2ngrZiW2iVS4aIwYmc
FKECK6fMtaNXVBDc8O99sZFCcUJZlMqPwvDV4Ssj8QqIHUanX64Kec7ThcJg
EorUg8XvVNLQ9tDtd/eRyHoU4Vn3PYXu8Y41JywkzGabwVI0C5bW8rZIPQND
Qc2fQXYlmrKmk6vdSlxAz15BGwPjeFFraQKBLaXSamq/FBODKbmJh2TwOtgg
7WMCfuaklMgKBhd/kyYWi1n4fuguOdcgwpunBEdyTTS23Exyd/YJsaBGoF92
i8YbsXV96ZnT3EBX3I+WNCUir9av9gz8y8X8/tevnzcq8YyKuPil2MdVw3H2
j+0Egu50fqR46zl398Ne98HjSlxLv+eT62ZjXvqRRZe/EiK25Pa7XrUYY7XP
Psu3iqDoUZ+QxirRUEDGfLdHDvKDTZWFVTScq3T3E6/JEJVvd3wbqMD8ORoD
P5YP29IzaVNeOdqfTPrnXefDNXHD6qpVIGRqwVzz5Ew86KD1mc0MKgxRZ5YU
UPhbH31s81wafVu/MJ4zMlBn133KriKQ+hOXwzMx2Pv1oDS9n4ZvB7u4yECg
g/OybToa7IAnvKKJRIFhxLY8koL2enaNdw4Fu+OwSyNRgbRkJhzbr8bbpwJa
irsCEbg9PPnpCgb/AZnISpY=
      "]]}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-0.5845113176147334, 7.437018186536111}, {
    0, 6.7622120389548375`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7522545388677483`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualising tree", "Section",
 CellChangeTimes->{{3.752246840122805*^9, 3.7522468578343477`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fNUTSstepSingle", "[", 
   RowBox[{
   "\[Theta]_", ",", "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetaMinus", "=", "\[Theta]"}], ",", 
      RowBox[{"thetaPlus", "=", "\[Theta]"}], ",", "mMinus", ",", "mPlus", 
      ",", 
      RowBox[{"j", "=", "0"}], ",", "C", ",", 
      RowBox[{"s", "=", "1"}], ",", "m", ",", "temp1", ",", "temp2", ",", 
      "Cprimed", ",", "sprimed", ",", "u", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "@", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "@", "\[Theta]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"UniformDistribution", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"logP", "[", "\[Theta]", "]"}], "-", 
              RowBox[{"0.5", " ", 
               RowBox[{"m", ".", "m"}]}]}], "]"}]}], "}"}], "]"}], ",", "1"}],
         "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mMinus", "=", "m"}], ";", 
     RowBox[{"mPlus", "=", "m"}], ";", 
     RowBox[{"C", "=", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "m"}], "}"}]}], ";", 
     RowBox[{"v", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"v", "\[Equal]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaPlus", ",", "mPlus", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sprimed", "\[Equal]", "1"}], ",", 
       RowBox[{"C", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"{", "C", "}"}], ",", 
          RowBox[{"{", "Cprimed", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"sprimed", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mMinus"}], 
          " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mPlus"}], 
          " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], "]"}]}]}],
      ";", 
     RowBox[{"j", " ", "=", " ", 
      RowBox[{"j", " ", "+", " ", "1"}]}], ";", "C"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstepSingleString", "[", 
   RowBox[{
   "thetaMinus_", ",", "mMinus_", ",", "thetaPlus_", ",", "mPlus_", ",", "C_",
     ",", "j_", ",", "s_", ",", "u_", ",", "\[Epsilon]_", ",", "logP_", ",", 
    "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetaMinus1", "=", "thetaMinus"}], ",", 
      RowBox[{"mMinus1", "=", "mMinus"}], ",", 
      RowBox[{"thetaPlus1", "=", "thetaPlus"}], ",", 
      RowBox[{"mPlus1", "=", "mPlus"}], ",", 
      RowBox[{"s1", "=", "s"}], ",", "temp1", ",", "temp2", ",", "Cprimed", 
      ",", "sprimed", ",", "v", ",", "C1", ",", "j1", ",", "dep"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"v", "\[Equal]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus1", ",", "mMinus1", ",", "temp1", ",", "temp2", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaMinus1", ",", "mMinus1", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "temp1", ",", "temp2", ",", "thetaPlus1", ",", "mPlus1", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaPlus1", ",", "mPlus", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dep", "=", 
      RowBox[{
       RowBox[{"Depth", "@", "Cprimed"}], "-", "4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sprimed", "\[Equal]", "1"}], ",", 
       RowBox[{"C1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "C", "}"}], ",", 
          RowBox[{"{", "Cprimed", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{"sprimed", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus1", "-", "thetaMinus1"}], ")"}], ".", 
           "mMinus1"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
         "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus1", "-", "thetaMinus1"}], ")"}], ".", 
           "mPlus1"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
         "0"}], "]"}]}]}], ";", 
     RowBox[{"j1", " ", "=", " ", 
      RowBox[{"j", " ", "+", " ", "1"}]}], ";", 
     RowBox[{"{", 
      RowBox[{
      "thetaMinus1", ",", " ", "mMinus1", ",", " ", "thetaPlus1", ",", " ", 
       "mPlus1", ",", "C1", ",", "j1", ",", "s1", ",", "u", ",", "\[Epsilon]",
        ",", "logP", ",", "\[CapitalDelta]"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fBuildTree", "[", 
   RowBox[{
   "\[Theta]_", ",", "m_", ",", "u_", ",", "v_", ",", "j_", ",", 
    "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Cprimed", ",", "Cprimedprimed", ",", "sprimed", ",", "sprimedprimed", 
      ",", "res", ",", "thetaMinus", ",", "thetaPlus", ",", "mMinus", ",", 
      "mPlus", ",", "temp1", ",", "temp2"}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"res", "=", 
        RowBox[{"fLeapFrogStep", "[", 
         RowBox[{"\[Theta]", ",", "m", ",", 
          RowBox[{"v", " ", "\[Epsilon]"}], ",", "logP"}], "]"}]}], ";", 
       RowBox[{"Cprimed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "u", "]"}], "\[LessEqual]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logP", "[", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"m", ".", "m"}]}]}], ")"}]}], ",", "res", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"sprimed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "u", "]"}], "<", 
           RowBox[{"(", 
            RowBox[{"\[CapitalDelta]", "+", 
             RowBox[{"logP", "[", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"m", ".", "m"}]}]}], ")"}]}], ",", "1", ",", "0"}], 
         "]"}]}], ";", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "Cprimed", ",", "sprimed"}], 
        "}"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "thetaPlus", ",", "mPlus", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{"\[Theta]", ",", "m", ",", "u", ",", "v", ",", 
          RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
          "\[CapitalDelta]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"v", "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
            "Cprimedprimed", ",", "sprimedprimed"}], "}"}], "=", 
          RowBox[{"fBuildTree", "[", 
           RowBox[{"thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", 
            RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
            "\[CapitalDelta]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
            "Cprimedprimed", ",", "sprimedprimed"}], "}"}], "=", 
          RowBox[{"fBuildTree", "[", 
           RowBox[{"thetaPlus", ",", "mMinus", ",", "u", ",", "v", ",", 
            RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
            "\[CapitalDelta]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"sprimed", "=", 
        RowBox[{"sprimed", " ", "sprimedprimed", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
             "mMinus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
           "0"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mPlus"}],
             " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], 
          "]"}]}]}], ";", 
       RowBox[{"Cprimed", " ", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "Cprimed", "}"}], ",", 
            RowBox[{"{", "Cprimedprimed", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"{", 
        RowBox[{
        "thetaMinus", ",", "mMinus", ",", "thetaPlus", ",", "mPlus", ",", 
         "Cprimed", ",", "sprimed"}], "}"}]}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7522488050062304`*^9, 3.752248829702606*^9}, {
   3.752248876538212*^9, 3.752248880225648*^9}, {3.7522489107154493`*^9, 
   3.7522489231232224`*^9}, {3.752248989231635*^9, 3.752249058417417*^9}, {
   3.752249218754447*^9, 3.752249228504674*^9}, {3.7522493394548483`*^9, 
   3.752249347614276*^9}, {3.75224943326779*^9, 3.7522494376903057`*^9}, {
   3.752249494356967*^9, 3.752249713279314*^9}, {3.7522497530902567`*^9, 
   3.752249753433041*^9}, {3.752249861990279*^9, 3.752249868983016*^9}, {
   3.752250643859624*^9, 3.752250648698619*^9}, {3.7522507211576967`*^9, 
   3.7522507449573517`*^9}, 3.752250881108919*^9, {3.752251084903672*^9, 
   3.752251178658659*^9}, {3.752251224932941*^9, 3.752251262230258*^9}, {
   3.752251311762228*^9, 3.752251334458077*^9}, {3.752251495826542*^9, 
   3.752251618510818*^9}, {3.752251705371059*^9, 3.752251719043494*^9}, {
   3.752251754390787*^9, 3.7522517789022617`*^9}, {3.752251863706205*^9, 
   3.752251885787624*^9}, {3.75225205344453*^9, 3.752252071147408*^9}, {
   3.752252120061808*^9, 3.75225214470299*^9}, {3.7522544424975977`*^9, 
   3.7522544427222137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fNUTSstring", "[", 
   RowBox[{
   "theta0_", ",", "m0_", ",", "u_", ",", "\[Epsilon]_", ",", "logP_", ",", 
    "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"NestWhileList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fNUTSstepSingleString", "@@", "#"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"theta0", ",", "m0", ",", "theta0", ",", "m0", ",", 
      RowBox[{"{", 
       RowBox[{"theta0", ",", "m0"}], "}"}], ",", "0", ",", "1", ",", "u", 
      ",", "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "1"}], " ", "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.752249912367115*^9, 3.752249930743882*^9}, {
   3.752249978586282*^9, 3.75225018580376*^9}, {3.752250254872417*^9, 
   3.752250301497896*^9}, {3.752250485740239*^9, 3.752250537365409*^9}, 
   3.752250587102705*^9, {3.7522507805208483`*^9, 3.752250788007677*^9}, 
   3.752253441034865*^9, {3.752253604762245*^9, 3.752253611786455*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fUnravel", "[", "lTree__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Length", "@", "lTree"}], ")"}], "-", "1"}]}], ",", "lDeps", 
      ",", "lAll"}], "}"}], ",", 
    RowBox[{
     RowBox[{"lDeps", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Depth", "@", 
         RowBox[{
          RowBox[{"lTree", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"lAll", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lTree", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"lDeps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "4"}], ">", "0"}], ",", 
            RowBox[{
             RowBox[{"lDeps", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "4"}], ",", "0"}], "]"}]}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"lAll", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"lAll", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.752252346224621*^9, 3.752252453260181*^9}, {
  3.752252530673006*^9, 3.752252602699275*^9}, {3.7522528034847803`*^9, 
  3.75225286078447*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x__", "]"}], ":=", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.5", ",", "0."}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.5"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "x", "}"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.752253288987712*^9, 3.7522532909221277`*^9}, {
  3.752253541190378*^9, 3.752253543190077*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"fNUTSstring", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4.6", ",", "5.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", 
       RowBox[{"-", "0.2"}]}], "}"}], ",", "1", ",", "0.5", ",", "f", ",", 
     "1000"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.752253089122629*^9, 3.752253102306047*^9}, {
  3.7522531447640953`*^9, 3.7522532590653257`*^9}, {3.752253342669443*^9, 
  3.752253386311288*^9}, {3.7522534453539743`*^9, 3.752253460434148*^9}, {
  3.7522534963903637`*^9, 3.7522535022037277`*^9}, {3.752253533911055*^9, 
  3.752253571488637*^9}, {3.752253654539249*^9, 3.7522536609393177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lAnimations", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fUnravel", "[", "test", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"Length", "@", "test"}], "-", "1"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7522524547097692`*^9, 3.75225245680367*^9}, {
   3.752252607420631*^9, 3.7522527829227343`*^9}, {3.7522528646005993`*^9, 
   3.752252894408337*^9}, {3.752252936773143*^9, 3.7522529844610023`*^9}, {
   3.752253131614113*^9, 3.752253136099477*^9}, {3.752253479701385*^9, 
   3.7522534835748167`*^9}, 3.752253634901188*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {0.1, -0.2}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.1, -0.2}}}]}, {}}}, {}, {}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0, 0.2}, {-0.4, 0}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.02]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {
         0.08683321731062961, -0.18607129095764596`}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.08683321731062961, -0.18607129095764596`}}}]}, {}}}, {}, {}, {{}, \
{}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0.0866274863311082, -0.18537485550552826`},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0.08683321731062961, 0.1}, {-0.2, -0.18607129095764596`}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {0.08683321731062961, -0.18607129095764596`}, {
         0.058592497578925096`, -0.15212741636715016`}, {
         0.07292978896297676, -0.169959757520009}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.08683321731062961, -0.18607129095764596`}}, {{
         0.058592497578925096`, -0.15212741636715016`}}, {{
         0.07292978896297676, -0.169959757520009}}}]}, {}}}, {}, {}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0.05794550535359581, -0.14973378718550764`},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0.058592497578925096`, 0.1}, {-0.2, -0.15212741636715016`}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {0.08683321731062961, -0.18607129095764596`}, {
         0.058592497578925096`, -0.15212741636715016`}, {
         0.07292978896297676, -0.169959757520009}, {
         0.0009592032295282788, -0.0705676121736793}, {
         0.015136556256857892`, -0.09197448891654406}, {
         0.029536014204020217`, -0.11284105108245239`}, {
         0.044065914857834926`, -0.1329775978747628}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.08683321731062961, -0.18607129095764596`}}, {{
         0.058592497578925096`, -0.15212741636715016`}}, {{
         0.07292978896297676, -0.169959757520009}}, {{
         0.0009592032295282788, -0.0705676121736793}}, {{
         0.015136556256857892`, -0.09197448891654406}}, {{
         0.029536014204020217`, -0.11284105108245239`}}, {{
         0.044065914857834926`, -0.1329775978747628}}}]}, {}}}, {}, {}, {{}, \
{}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0, 0.1}, {-0.2, 0}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.02]}},
    Ticks->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7522534839710493`*^9, 3.7522535047725487`*^9}, {
   3.75225353516398*^9, 3.75225357279467*^9}, {3.752253635539049*^9, 
   3.7522536622007723`*^9}, 3.752253880191641*^9, 3.752254418584793*^9, 
   3.752254546540976*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListAnimate", "[", "lAnimations", "]"}]], "Input",
 CellChangeTimes->{{3.7522534037525177`*^9, 3.7522534064806013`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i11$$ = 5, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {
    "\"min\"" :> {$CellContext`i11$$ = 1}, 
     "\"max\"" :> {$CellContext`i11$$ = 5}}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`i11$$], 1, ""}, 1, 5, 1}}, Typeset`size$$ = 
    Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i11$3008763$$ = 0}, 
    PaneBox[
     PanelBox[
      DynamicWrapperBox[GridBox[{
         {
          ItemBox[
           ItemBox[
            TagBox[
             StyleBox[GridBox[{
                {"\<\"\"\>", 
                 AnimatorBox[Dynamic[$CellContext`i11$$], {1, 5, 1},
                  AnimationRate->Automatic,
                  AnimationRunTime->4.792057037353516,
                  AnimationRunning->False,
                  AnimationTimeIndex->4.792057037353516,
                  
                  AppearanceElements->{
                   "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons",
                     "DirectionButton"},
                  AutoAction->False,
                  DisplayAllSteps->True]}
               },
               AutoDelete->False,
               
               GridBoxAlignment->{
                "Columns" -> {Right, {Left}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "ListAnimateLabel",
              StripOnInput->False],
             {"ControlArea", Top}],
            Alignment->{Automatic, Inherited},
            StripOnInput->False],
           Background->None,
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            StyleBox[
             PaneBox[
              TagBox[
               PaneSelectorBox[{1->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.6, 5.4}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{4.6, 
                    5.4}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{0, 0},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 PlotRange->{{0, 9.2}, {0, 10.8}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.02], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 2->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 
                    5.496821056031902}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.5524473649676, 5.3951589471984045`},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.553178943968098, 4.6}, {5.4, 
                  5.496821056031902}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 3->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}, {4.653178943968098, 
                    5.296821056031902}, {4.712079466765697, 
                    5.188745393595286}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 5.496821056031902}}, {{
                    4.653178943968098, 5.296821056031902}}, {{
                    4.712079466765697, 
                    5.188745393595286}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.550696123299385, 5.1733416104734555`},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.553178943968098, 4.712079466765697}, {
                  5.188745393595286, 5.496821056031902}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 4->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}, {4.653178943968098, 
                    5.296821056031902}, {4.712079466765697, 
                    5.188745393595286}, {4.7758743087669355`, 
                    5.077461275707109}, {4.843558964142576, 
                    4.964832778669063}, {4.910670151304915, 
                    4.8531847642320685`}, {4.979345561435977, 
                    4.744107578776669}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 5.496821056031902}}, {{
                    4.653178943968098, 5.296821056031902}}, {{
                    4.712079466765697, 5.188745393595286}}, {{
                    4.7758743087669355`, 5.077461275707109}}, {{
                    4.843558964142576, 4.964832778669063}}, {{
                    4.910670151304915, 4.8531847642320685`}}, {{
                    4.979345561435977, 
                    4.744107578776669}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.546520090570162, 4.706471904913907},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.553178943968098, 4.979345561435977}, {
                  4.744107578776669, 5.496821056031902}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 5->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}, {4.653178943968098, 
                    5.296821056031902}, {4.712079466765697, 
                    5.188745393595286}, {4.7758743087669355`, 
                    5.077461275707109}, {4.843558964142576, 
                    4.964832778669063}, {4.910670151304915, 
                    4.8531847642320685`}, {4.979345561435977, 
                    4.744107578776669}, {4.421046683890428, 
                    5.891732900343218}, {4.425038270906425, 
                    5.851039758407249}, {4.424079067676896, 
                    5.9216073705809285`}, {4.433981609079613, 
                    5.940487991592413}, {4.436183240147287, 
                    5.799758411426674}, {4.4545742851104455`, 
                    5.738198707324797}, {4.480249155005121, 
                    5.666780813551911}, {4.51316678268937, 
                    5.586071290957647}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 5.496821056031902}}, {{
                    4.653178943968098, 5.296821056031902}}, {{
                    4.712079466765697, 5.188745393595286}}, {{
                    4.7758743087669355`, 5.077461275707109}}, {{
                    4.843558964142576, 4.964832778669063}}, {{
                    4.910670151304915, 4.8531847642320685`}}, {{
                    4.979345561435977, 4.744107578776669}}, {{
                    4.421046683890428, 5.891732900343218}}, {{
                    4.425038270906425, 5.851039758407249}}, {{
                    4.424079067676896, 5.9216073705809285`}}, {{
                    4.433981609079613, 5.940487991592413}}, {{
                    4.436183240147287, 5.799758411426674}}, {{
                    4.4545742851104455`, 5.738198707324797}}, {{
                    4.480249155005121, 5.666780813551911}}, {{
                    4.51316678268937, 
                    5.586071290957647}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.412323263928779, 4.684288558135882},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.421046683890428, 4.979345561435977}, {
                  4.744107578776669, 5.940487991592413}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}]}, Dynamic[$CellContext`i11$$],
                
                Alignment->Automatic,
                ImageSize->All,
                TransitionDirection->Horizontal,
                TransitionDuration->0.5,
                TransitionEffect->Automatic],
               Identity,
               Editable->True,
               Selectable->True],
              ImageMargins->10],
             Deployed->False,
             StripOnInput->False,
             ScriptLevel->0,
             GraphicsBoxOptions->{PreserveImageOptions->True},
             Graphics3DBoxOptions->{PreserveImageOptions->True}],
            Identity,
            Editable->False,
            Selectable->False],
           Alignment->{Left, Center},
           Background->GrayLevel[1],
           Frame->1,
           FrameStyle->GrayLevel[0, 0.2],
           ItemSize->Automatic,
           StripOnInput->False]}
        },
        AutoDelete->False,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Top}}, 
          "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
          "RowsIndexed" -> {}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.7], {
             Offset[0.5599999999999999]}, 
            Offset[0.7]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.4], {
             Offset[0.8]}, 
            Offset[0.4]}, "RowsIndexed" -> {}}], If[
        And[
         CurrentValue["NotebookSelected"], 
         CurrentValue["SelectionOver"]], 
        Manipulate`Dump`ReadControllerState[
         Map[Manipulate`Dump`updateOneVar[#, 
           CurrentValue["PreviousFormatTime"], 
           CurrentValue["CurrentFormatTime"]]& , {
           
           Manipulate`Dump`controllerLink[{$CellContext`i11$$, \
$CellContext`i11$3008763$$}, "X1", 
            If["DefaultAbsolute", True, "JB1"], False, {1, 5, 1}, 5, 1.]}], 
         CurrentValue[{
          "ControllerData", {
           "Gamepad", "Joystick", "Multi-Axis Controller"}}], {}]],
       ImageSizeCache->{393., {144.384033203125, 150.115966796875}}],
      DefaultBaseStyle->{},
      FrameMargins->{{5, 5}, {5, 5}}],
     BaselinePosition->Automatic,
     ImageMargins->0],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "ListAnimate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.75225340683633*^9, {3.752253447442727*^9, 3.7522535084339027`*^9}, {
   3.752253547005416*^9, 3.7522535746862307`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1406, 1008},
WindowMargins->{{Automatic, 331}, {112, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 289, 6, 32, "Input"],
Cell[850, 28, 13390, 352, 663, "Input"],
Cell[14243, 382, 390, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[14658, 396, 265, 6, 32, "Input"],
Cell[14926, 404, 2541, 54, 252, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17504, 463, 103, 1, 64, "Section"],
Cell[17610, 466, 13215, 331, 642, "Input"],
Cell[30828, 799, 1066, 24, 32, "Input"],
Cell[31897, 825, 2052, 59, 75, "Input"],
Cell[33952, 886, 697, 20, 32, "Input"],
Cell[34652, 908, 688, 15, 32, "Input"],
Cell[CellGroupData[{
Cell[35365, 927, 1017, 24, 32, "Input"],
Cell[36385, 953, 8324, 181, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44746, 1139, 144, 2, 32, "Input"],
Cell[44893, 1143, 20424, 438, 325, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

