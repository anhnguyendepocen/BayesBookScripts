(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106474,       2482]
NotebookOptionsPosition[    104040,       2410]
NotebookOutlinePosition[    104403,       2426]
CellTagsIndexPosition[    104360,       2423]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.752238819415077*^9, 3.752238826229746*^9}, {
  3.752239964338439*^9, 3.752239964499198*^9}, {3.752246926696396*^9, 
  3.7522469269579763`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x__", "]"}], ":=", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.5", ",", "0.25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.25", ",", "1.5"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "x", "}"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fDerivative", "[", 
   RowBox[{"f_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Length", "[", "z", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "@@", "v"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"v", "\[Rule]", "z"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fLeapFrogStep", "[", 
   RowBox[{"\[Theta]_", ",", "m_", ",", "\[Epsilon]_", ",", "logP_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"grad", ",", "x", ",", "\[Theta]1", ",", "m1", ",", "grad1"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"grad", "=", 
      RowBox[{"fDerivative", "[", 
       RowBox[{"logP", ",", "\[Theta]"}], "]"}]}], ";", 
     RowBox[{"m1", "=", 
      RowBox[{"m", "+", 
       RowBox[{"0.5", " ", "\[Epsilon]", " ", "grad"}]}]}], ";", " ", 
     RowBox[{"\[Theta]1", "=", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{"\[Epsilon]", " ", "m1"}]}]}], ";", 
     RowBox[{"grad1", "=", 
      RowBox[{"fDerivative", "[", 
       RowBox[{"logP", ",", "\[Theta]1"}], "]"}]}], ";", 
     RowBox[{"m1", "=", 
      RowBox[{"m1", "+", 
       RowBox[{"0.5", " ", "\[Epsilon]", " ", "grad1"}]}]}], ";", 
     RowBox[{"{", 
      RowBox[{"\[Theta]1", ",", "m1"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fBuildTree", "[", 
   RowBox[{
   "\[Theta]_", ",", "m_", ",", "u_", ",", "v_", ",", "j_", ",", 
    "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Cprimed", ",", "Cprimedprimed", ",", "sprimed", ",", "sprimedprimed", 
      ",", "res", ",", "thetaMinus", ",", "thetaPlus", ",", "mMinus", ",", 
      "mPlus", ",", "temp1", ",", "temp2"}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"res", "=", 
        RowBox[{"fLeapFrogStep", "[", 
         RowBox[{"\[Theta]", ",", "m", ",", 
          RowBox[{"v", " ", "\[Epsilon]"}], ",", "logP"}], "]"}]}], ";", 
       RowBox[{"Cprimed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "u", "]"}], "\[LessEqual]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"logP", "[", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"m", ".", "m"}]}]}], ")"}]}], ",", "res", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"sprimed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "u", "]"}], "<", 
           RowBox[{"(", 
            RowBox[{"\[CapitalDelta]", "+", 
             RowBox[{"logP", "[", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"m", ".", "m"}]}]}], ")"}]}], ",", "1", ",", "0"}], 
         "]"}]}], ";", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "Cprimed", ",", "sprimed"}], 
        "}"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "thetaPlus", ",", "mPlus", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{"\[Theta]", ",", "m", ",", "u", ",", "v", ",", 
          RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
          "\[CapitalDelta]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"v", "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
            "Cprimedprimed", ",", "sprimedprimed"}], "}"}], "=", 
          RowBox[{"fBuildTree", "[", 
           RowBox[{"thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", 
            RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
            "\[CapitalDelta]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
            "Cprimedprimed", ",", "sprimedprimed"}], "}"}], "=", 
          RowBox[{"fBuildTree", "[", 
           RowBox[{"thetaPlus", ",", "mMinus", ",", "u", ",", "v", ",", 
            RowBox[{"j", "-", "1"}], ",", "\[Epsilon]", ",", "logP", ",", 
            "\[CapitalDelta]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"sprimed", "=", 
        RowBox[{"sprimed", " ", "sprimedprimed", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
             "mMinus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
           "0"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mPlus"}],
             " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], 
          "]"}]}]}], ";", 
       RowBox[{"Cprimed", " ", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "Cprimed", "}"}], ",", 
            RowBox[{"{", "Cprimedprimed", "}"}]}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"{", 
        RowBox[{
        "thetaMinus", ",", "mMinus", ",", "thetaPlus", ",", "mPlus", ",", 
         "Cprimed", ",", "sprimed"}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstep", "[", 
   RowBox[{
   "\[Theta]_", ",", "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetaMinus", "=", "\[Theta]"}], ",", 
      RowBox[{"thetaPlus", "=", "\[Theta]"}], ",", "mMinus", ",", "mPlus", 
      ",", 
      RowBox[{"j", "=", "0"}], ",", "C", ",", 
      RowBox[{"s", "=", "1"}], ",", "m", ",", "temp1", ",", "temp2", ",", 
      "Cprimed", ",", "sprimed", ",", "u", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "@", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "@", "\[Theta]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"UniformDistribution", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"logP", "[", "\[Theta]", "]"}], "-", 
              RowBox[{"0.5", " ", 
               RowBox[{"m", ".", "m"}]}]}], "]"}]}], "}"}], "]"}], ",", "1"}],
         "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mMinus", "=", "m"}], ";", 
     RowBox[{"mPlus", "=", "m"}], ";", 
     RowBox[{"C", "=", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "m"}], "}"}]}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"s", "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"RandomChoice", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"v", "\[Equal]", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
             "Cprimed", ",", "sprimed"}], "}"}], "=", 
           RowBox[{"fBuildTree", "[", 
            RowBox[{
            "thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", "j", ",", 
             "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
             "Cprimed", ",", "sprimed"}], "}"}], "=", 
           RowBox[{"fBuildTree", "[", 
            RowBox[{
            "thetaPlus", ",", "mPlus", ",", "u", ",", "v", ",", "j", ",", 
             "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sprimed", "\[Equal]", "1"}], ",", 
          RowBox[{"C", "=", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"{", "C", "}"}], ",", 
             RowBox[{"{", "Cprimed", "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{"sprimed", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
              "mMinus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
            "0"}], "]"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", 
              "mPlus"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
            "0"}], "]"}]}]}], ";", 
        RowBox[{"j", " ", "=", " ", 
         RowBox[{"j", " ", "+", " ", "1"}]}]}]}], "]"}], ";", "C"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstepExtract", "[", "c_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dep", "=", 
      RowBox[{"Depth", "@", "c"}]}], "}"}], ",", 
    RowBox[{"RandomChoice", "@", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"c", ",", 
         RowBox[{"dep", "-", "4"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstepComplete", "[", 
   RowBox[{
   "\[Theta]_", ",", "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "=", 
      RowBox[{"fNUTSstep", "[", 
       RowBox[{
       "\[Theta]", ",", "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"fNUTSstepExtract", "[", "c", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTS", "[", 
   RowBox[{
   "M_Integer", ",", "\[Theta]0_", ",", "\[Epsilon]_", ",", "logP_", ",", 
    "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fNUTSstepComplete", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Epsilon]", ",", "logP", ",", 
       "\[CapitalDelta]"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]0", ",", 
      RowBox[{"{", "}"}]}], "}"}], ",", "M"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.752241656626203*^9, 3.752241701486404*^9}, {
   3.7522417374734*^9, 3.752241828537655*^9}, {3.752241868186348*^9, 
   3.7522418879097*^9}, {3.7522419918601017`*^9, 3.752242187343792*^9}, {
   3.7522422198022842`*^9, 3.752242223177862*^9}, {3.752242261379641*^9, 
   3.752242497584846*^9}, {3.752242537963459*^9, 3.7522425493917522`*^9}, {
   3.752242585883156*^9, 3.7522426865105333`*^9}, {3.752242723633382*^9, 
   3.7522428295423803`*^9}, 3.752242860112129*^9, {3.7522429132236443`*^9, 
   3.752243078848131*^9}, {3.752244128999853*^9, 3.7522441343109007`*^9}, {
   3.7522469086878147`*^9, 3.752246915785604*^9}, {3.752247355933969*^9, 
   3.752247381790059*^9}, {3.75224824179998*^9, 3.7522482454229517`*^9}, {
   3.752252301841056*^9, 3.7522523054725847`*^9}, {3.7522539322677402`*^9, 
   3.752253948299914*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"samples", "=", 
   RowBox[{"fNUTS", "[", 
    RowBox[{"50", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "0.1", ",", "f", ",", "1000"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.752246461818357*^9, 3.75224647383322*^9}, 
   3.752246503892144*^9, 3.7522465378697*^9, {3.7522474117164583`*^9, 
   3.7522474352935667`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Flatten","flev",
   "\"The level argument \\!\\(\\*RowBox[{\\\"-\\\", \\\"1\\\"}]\\) in \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"18.331776346070058`\\\"}], \\\",\\\", \
\\\"46.39012965508475`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.0846111826685987`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3621167723627385`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) should be a non-negative \
integer or Infinity giving the levels to flatten through or a list of lists \
of levels to flatten together.\"",2,988,209,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253806929853*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomChoice","lrwl",
   "\"The items for choice \\!\\(\\*RowBox[{\\\"Flatten\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\
\", \\\"18.331776346070058`\\\"}], \\\",\\\", \\\"46.39012965508475`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.0846111826685987`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3621167723627385`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) should be a list or a rule \
weights -> choices.\"",2,988,210,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253806949881*^9}],

Cell[BoxData[
 TemplateBox[{
  "Flatten","flev",
   "\"The level argument \\!\\(\\*RowBox[{\\\"-\\\", \\\"1\\\"}]\\) in \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"18.331776346070058`\\\"}], \\\",\\\", \
\\\"46.39012965508475`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.0846111826685987`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3621167723627385`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) should be a non-negative \
integer or Infinity giving the levels to flatten through or a list of lists \
of levels to flatten together.\"",2,988,211,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253806965076*^9}],

Cell[BoxData[
 TemplateBox[{
  "Flatten","flev",
   "\"The level argument \\!\\(\\*RowBox[{\\\"-\\\", \\\"1.`\\\"}]\\) in \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"18.331776346070058`\\\"}], \\\",\\\", \
\\\"46.39012965508475`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.0846111826685987`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3621167723627385`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`\\\"}]}], \\\"]\\\"}]\\) should be a non-negative \
integer or Infinity giving the levels to flatten through or a list of lists \
of levels to flatten together.\"",2,988,212,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538069801064`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Flatten\\\", \
\\\"::\\\", \\\"flev\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,988,213,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253806994855*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomVariate","unifr",
   "\"-- Message text not found -- \
(\\!\\(\\*RowBox[{\\\"UniformDistribution\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.9182011140083369`\\\"}], \\\"+\\\", RowBox[{\
\\\"PDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"5\\\", \\\",\\\", \
\\\"5\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}], \\\"}\\\"}]}], \
\\\"]\\\"}]}]]}], \\\"}\\\"}], \\\"]\\\"}]\\))\"",2,988,214,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538070105*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"0.8807879710643851`\\\"}], \\\")\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,988,215,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807026927*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomVariate","unifr",
   "\"-- Message text not found -- \
(\\!\\(\\*RowBox[{\\\"UniformDistribution\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.4182222518441248`\\\"}], \\\"+\\\", RowBox[{\
\\\"PDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"5\\\", \\\",\\\", \
\\\"5\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"0.8807879710643851`\\\"}], \\\")\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}]}]]}], \\\"}\\\"}], \\\"]\\\"}]\\))\"",2,988,216,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807041678*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomChoice","lrwl",
   "\"The items for choice \\!\\(\\*RowBox[{\\\"Flatten\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"-\\\
\", \\\"0.8807879710643851`\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.9128600912479141`\\\"}], \\\",\\\", \
\\\"0.055954959521918174`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) should be a list or a rule \
weights -> choices.\"",2,988,217,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807058255*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomVariate","unifr",
   "\"-- Message text not found -- \
(\\!\\(\\*RowBox[{\\\"UniformDistribution\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"2.758435420550139`\\\"}], \\\"+\\\", \
RowBox[{\\\"PDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"5\\\", \\\",\\\", \\\"5\
\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}], \\\"}\\\"}]}], \
\\\"]\\\"}]}]]}], \\\"}\\\"}], \\\"]\\\"}]\\))\"",2,988,218,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538070731688`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"RandomVariate\\\", \
\\\"::\\\", \\\"unifr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,988,219,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538070877867`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"0.39110485250334953`\\\"}], \\\")\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,988,220,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807102561*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomChoice","lrwl",
   "\"The items for choice \\!\\(\\*RowBox[{\\\"Flatten\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"-\\\
\", \\\"0.39110485250334953`\\\"}], \\\")\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.8521037025664714`\\\", \\\",\\\", \
\\\"0.5075759295953035`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]\\) should be a list or a rule \
weights -> choices.\"",2,988,221,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807117598*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"RandomChoice\\\", \
\\\"::\\\", \\\"lrwl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,988,222,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807132629*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"0.1883335678396456`\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,988,223,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538071475286`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,988,224,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807162821*^9}],

Cell[BoxData[
 TemplateBox[{
  "IdentityMatrix","dims",
   "\"Dimension specification \\!\\(\\*RowBox[{\\\"0\\\"}]\\) should be a \
positive machine integer or a pair of positive machine integers.\"",2,988,225,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807243681*^9}],

Cell[BoxData[
 TemplateBox[{
  "MultinormalDistribution","posdefprm",
   "\"The value \\!\\(\\*RowBox[{\\\"IdentityMatrix\\\", \\\"[\\\", \
\\\"0\\\", \\\"]\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"{\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"IdentityMatrix\\\", \\\"[\\\", \
\\\"0\\\", \\\"]\\\"}]}], \\\"]\\\"}]\\) is expected to be a symmetric \
positive definite matrix.\"",2,988,226,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807258584*^9}],

Cell[BoxData[
 TemplateBox[{
  "IdentityMatrix","dims",
   "\"Dimension specification \\!\\(\\*RowBox[{\\\"0.`\\\"}]\\) should be a \
positive machine integer or a pair of positive machine integers.\"",2,988,227,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807272788*^9}],

Cell[BoxData[
 TemplateBox[{
  "IdentityMatrix","dims",
   "\"Dimension specification \\!\\(\\*RowBox[{\\\"0.`\\\"}]\\) should be a \
positive machine integer or a pair of positive machine integers.\"",2,988,228,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807287969*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"IdentityMatrix\\\", \
\\\"::\\\", \\\"dims\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,988,229,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807302053*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"samples", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.752246488356022*^9, 3.752246492579344*^9}, {
  3.752246960008864*^9, 3.752246961343184*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"21.79734912276026`\\\"}], \\\",\\\", \
\\\"12.021244590353755`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0844452289479656`\\\"}], \\\",\\\", \
\\\"0.5980718710409664`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.5152481089828167`\\\", \\\",\\\", \\\
\"13.822233291173571`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0361154325219135`\\\"}], \\\",\\\", RowBox[{\
\\\"-\\\", \\\"0.08004394225866`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"9.923943753894791`\\\", \\\",\\\", \\\"1.227534004383577`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.3110119698227651`\\\"}], \\\",\\\", \\\"2.01195236245051`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.9363147172540214`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"2.8302655308388034`\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.6994957122994265`\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"0.8633612773536561`\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"41\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.074777817806632`\\\", \\\",\\\", \
\\\"0.7218263360341614`\\\"}], \\\"}\\\"}], \\\",\\\", \\\"2.074777817806632`\
\\\", \\\",\\\", RowBox[{\\\"RandomChoice\\\", \\\"[\\\", RowBox[{\\\"Flatten\
\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"2.074777817806632`\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.25952977498919555`\\\", \\\",\\\", \
\\\"0.05497127474653627`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"0.590667282570403`\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\
\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,989,230,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538074019327`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Flatten","flev",
   "\"The level argument \\!\\(\\*RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]\\) in \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"18.331776346070058`\\\"}], \\\",\\\", \
\\\"46.39012965508475`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.0846111826685987`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3621167723627385`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \\\"]\\\"}]\\) should be a \
non-negative integer or Infinity giving the levels to flatten through or a \
list of lists of levels to flatten together.\"",2,989,231,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807487781*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomChoice","lrwl",
   "\"The items for choice \\!\\(\\*RowBox[{\\\"Flatten\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\
\", \\\"18.331776346070058`\\\"}], \\\",\\\", \\\"46.39012965508475`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.0846111826685987`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.3621167723627385`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \\\"]\\\"}]\\) should be a list or a \
rule weights -> choices.\"",2,989,232,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807530642*^9}],

Cell[BoxData[
 TemplateBox[{
  "Flatten","flev",
   "\"The level argument \\!\\(\\*RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]\\) in \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"0.8807879710643851`\\\"}], \\\")\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"0.9128600912479141`\\\"}], \\\",\\\", \\\"0.055954959521918174`\\\"}], \\\
\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \
\\\"]\\\"}]\\) should be a non-negative integer or Infinity giving the levels \
to flatten through or a list of lists of levels to flatten together.\"",2,989,
   233,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807587323*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomChoice","lrwl",
   "\"The items for choice \\!\\(\\*RowBox[{\\\"Flatten\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"-\\\
\", \\\"0.8807879710643851`\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.9128600912479141`\\\"}], \\\",\\\", \
\\\"0.055954959521918174`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \\\"]\\\"}]\\) should be a list or a \
rule weights -> choices.\"",2,989,234,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807602881*^9}],

Cell[BoxData[
 TemplateBox[{
  "Flatten","flev",
   "\"The level argument \\!\\(\\*RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]\\) in \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"0.39110485250334953`\\\"}], \\\")\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0.8521037025664714`\\\", \\\",\\\", \
\\\"0.5075759295953035`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \\\"]\\\"}]\\) should be a \
non-negative integer or Infinity giving the levels to flatten through or a \
list of lists of levels to flatten together.\"",2,989,235,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807667706*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Flatten\\\", \
\\\"::\\\", \\\"flev\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,989,236,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807683683*^9}],

Cell[BoxData[
 TemplateBox[{
  "RandomChoice","lrwl",
   "\"The items for choice \\!\\(\\*RowBox[{\\\"Flatten\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"-\\\
\", \\\"0.39110485250334953`\\\"}], \\\")\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.8521037025664714`\\\", \\\",\\\", \
\\\"0.5075759295953035`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \\\"]\\\"}]\\) should be a list or a \
rule weights -> choices.\"",2,989,237,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807698496*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"RandomChoice\\\", \
\\\"::\\\", \\\"lrwl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,989,238,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807767115*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"21.79734912276026`\\\"}], \\\",\\\", \
\\\"12.021244590353755`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0844452289479656`\\\"}], \\\",\\\", \
\\\"0.5980718710409664`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.5152481089828167`\\\", \\\",\\\", \\\
\"13.822233291173571`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0361154325219135`\\\"}], \\\",\\\", RowBox[{\
\\\"-\\\", \\\"0.08004394225866`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"9.923943753894791`\\\", \\\",\\\", \\\"1.227534004383577`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.3110119698227651`\\\"}], \\\",\\\", \\\"2.01195236245051`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.9363147172540214`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"2.8302655308388034`\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.6994957122994265`\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"0.8633612773536561`\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"41\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.074777817806632`\\\", \\\",\\\", \
\\\"0.7218263360341614`\\\"}], \\\"}\\\"}], \\\",\\\", \\\"2.074777817806632`\
\\\", \\\",\\\", RowBox[{\\\"RandomChoice\\\", \\\"[\\\", RowBox[{\\\"Flatten\
\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"2.074777817806632`\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.25952977498919555`\\\", \\\",\\\", \
\\\"0.05497127474653627`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`16.\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"0.590667282570403`\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\
\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,989,239,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538077820263`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\
\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\
\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"21.79734912276026`\\\"}], \\\",\\\", \
\\\"12.021244590353755`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0844452289479656`\\\"}], \\\",\\\", \
\\\"0.5980718710409664`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.5152481089828167`\\\", \\\",\\\", \\\
\"13.822233291173571`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0361154325219135`\\\"}], \\\",\\\", RowBox[{\
\\\"-\\\", \\\"0.08004394225866`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"9.923943753894791`\\\", \\\",\\\", \\\"1.227534004383577`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.3110119698227651`\\\"}], \\\",\\\", \\\"2.01195236245051`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.9363147172540214`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"2.8302655308388034`\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.6994957122994265`\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"0.8633612773536561`\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"41\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.074777817806632`\\\", \\\",\\\", \
\\\"0.7218263360341614`\\\"}], \\\"}\\\"}], \\\",\\\", \\\"2.074777817806632`\
\\\", \\\",\\\", RowBox[{\\\"RandomChoice\\\", \\\"[\\\", RowBox[{\\\"Flatten\
\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"2.074777817806632`\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.25952977498919555`\\\", \\\",\\\", \
\\\"0.05497127474653627`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"0.590667282570403`\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\
\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"",2,989,240,
   26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538077981052`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,989,241,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.752253807867075*^9}],

Cell[BoxData[
 TemplateBox[{
  "ListLinePlot","lpn",
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"21.79734912276026`\\\"}], \\\",\\\", \
\\\"12.021244590353755`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0844452289479656`\\\"}], \\\",\\\", \
\\\"0.5980718710409664`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.5152481089828167`\\\", \\\",\\\", \\\
\"13.822233291173571`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0361154325219135`\\\"}], \\\",\\\", RowBox[{\
\\\"-\\\", \\\"0.08004394225866`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"9.923943753894791`\\\", \\\",\\\", \\\"1.227534004383577`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.3110119698227651`\\\"}], \\\",\\\", \\\"2.01195236245051`\\\"}], \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1.9363147172540214`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"2.8302655308388034`\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.6994957122994265`\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"0.8633612773536561`\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"41\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.074777817806632`\\\", \\\",\\\", \
\\\"0.7218263360341614`\\\"}], \\\"}\\\"}], \\\",\\\", \\\"2.074777817806632`\
\\\", \\\",\\\", RowBox[{\\\"RandomChoice\\\", \\\"[\\\", RowBox[{\\\"Flatten\
\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"2.074777817806632`\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.25952977498919555`\\\", \\\",\\\", \
\\\"0.05497127474653627`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.`\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"0.590667282570403`\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\
\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is not a list of numbers or pairs of \
numbers.\"",2,989,242,26380488669576047695,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7522538078828773`*^9}],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.79734912276026`"}], ",", "12.021244590353755`"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.0844452289479656`"}], ",", "0.5980718710409664`"}], 
        "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.5152481089828167`", ",", "13.822233291173571`"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.0361154325219135`"}], ",", 
         RowBox[{"-", "0.08004394225866`"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9.923943753894791`", ",", "1.227534004383577`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.3110119698227651`"}], ",", "2.01195236245051`"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.9363147172540214`", ",", 
         RowBox[{"-", "2.8302655308388034`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.6994957122994265`"}], ",", 
         RowBox[{"-", "0.8633612773536561`"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23.375064197954288`", ",", "19.490637747174183`"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.4286129815928976`", ",", "0.4467076882254122`"}], "}"}], 
       ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23.19406366980885`", ",", "19.25163381143536`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.30166754690906317`", ",", "0.39833989289803023`"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "18.331776346070058`"}], ",", "46.39012965508475`"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.6071029242087582`"}], ",", "0.3967616351410672`"}], 
        "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "18.331776346070058`"}], ",", "46.39012965508475`"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.0846111826685987`", ",", 
            RowBox[{"-", "1.3621167723627385`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", "0.8807879710643851`"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.8807879710643851`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.9128600912479141`"}], ",", 
            "0.055954959521918174`"}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", "0.39110485250334953`"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.39110485250334953`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.8521037025664714`", ",", "0.5075759295953035`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.1883335678396456`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "0.1883335678396456`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.0252776429686492`", ",", 
            RowBox[{"-", "1.5963599227871965`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.23395857663166175`", ",", 
     
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.16977968539177984`", ",", "0.29729492295991333`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.16977968539177984`", ",", "0.29729492295991333`"}], 
          "}"}]}], "}"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.16977968539177984`", ",", "0.29729492295991333`"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.06509204838635953`"}], ",", 
            RowBox[{"-", "1.0856189311490345`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.06509204838635953`"}], ",", 
           RowBox[{"-", "1.0856189311490345`"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.06509204838635953`"}], ",", 
         RowBox[{"-", "1.0856189311490345`"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "0.23395857663166175`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2.0309245436290024`"}], ",", 
            RowBox[{"-", "1.2694298080854889`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.46518864155961503`", ",", 
     
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "0.46518864155961503`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.2681735008643155`", ",", "1.3221964056848081`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.8222493712514863`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "0.8222493712514863`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.2434623114075478`", ",", "0.3374878232279148`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", "0.4282930397830417`"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.4282930397830417`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.1130026035856142`"}], ",", 
            RowBox[{"-", "0.09127267960523198`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "0.4282930397830417`"}], ")"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.1130026035856142`"}], ",", 
           RowBox[{"-", "0.09127267960523198`"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "0.4282930397830417`"}], ")"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.1130026035856142`"}], ",", 
         RowBox[{"-", "0.09127267960523198`"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.4282930397830417`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.3301878869986494`", ",", 
            RowBox[{"-", "0.1703779286017092`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "1.3539930147419372`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "1.3539930147419372`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.32723041375682815`", ",", "0.5252415860267118`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "1.172977689941228`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "1.172977689941228`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2.4280158873150897`"}], ",", 
            RowBox[{"-", "0.6536445301908783`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "1.845360990603438`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "1.845360990603438`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35742898290627534`"}], ",", 
            "0.867728515965433`"}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", "0.3939998895834645`"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.3939998895834645`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.21317043354181905`", ",", "0.8451333078058584`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "0.3939998895834645`"}], ")"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.21317043354181905`", ",", "0.8451333078058584`"}], 
          "}"}]}], "}"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "0.3939998895834645`"}], ")"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.21317043354181905`", ",", "0.8451333078058584`"}], "}"}]}],
       "}"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.3939998895834645`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.7634917717193608`", ",", "0.4360194050657171`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "1.4265090845547908`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "1.4265090845547908`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.7042459754314918`"}], ",", 
            "1.1496217211591742`"}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "1.4265090845547908`", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.7042459754314918`"}], ",", "1.1496217211591742`"}],
           "}"}]}], "}"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.074777817806632`", ",", "0.7218263360341614`"}], "}"}], ",", 
     "2.074777817806632`", ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "2.074777817806632`", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.25952977498919555`", ",", "0.05497127474653627`"}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"-", "0.590667282570403`"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "0.590667282570403`"}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.053442935190777544`"}], ",", 
            RowBox[{"-", "1.5431511477643152`"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]], "Output",
 CellChangeTimes->{{3.7522464928876534`*^9, 3.752246513819666*^9}, 
   3.752246589659252*^9, 3.7522468382287617`*^9, 3.752246961916052*^9, 
   3.752247429563388*^9, 3.752247503737941*^9, 3.752248548789719*^9, 
   3.752253807902295*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualising tree", "Section",
 CellChangeTimes->{{3.752246840122805*^9, 3.7522468578343477`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fNUTSstepSingle", "[", 
   RowBox[{
   "\[Theta]_", ",", "\[Epsilon]_", ",", "logP_", ",", "\[CapitalDelta]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetaMinus", "=", "\[Theta]"}], ",", 
      RowBox[{"thetaPlus", "=", "\[Theta]"}], ",", "mMinus", ",", "mPlus", 
      ",", 
      RowBox[{"j", "=", "0"}], ",", "C", ",", 
      RowBox[{"s", "=", "1"}], ",", "m", ",", "temp1", ",", "temp2", ",", 
      "Cprimed", ",", "sprimed", ",", "u", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "@", "\[Theta]"}]}], "]"}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "@", "\[Theta]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"UniformDistribution", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"logP", "[", "\[Theta]", "]"}], "-", 
              RowBox[{"0.5", " ", 
               RowBox[{"m", ".", "m"}]}]}], "]"}]}], "}"}], "]"}], ",", "1"}],
         "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mMinus", "=", "m"}], ";", 
     RowBox[{"mPlus", "=", "m"}], ";", 
     RowBox[{"C", "=", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "m"}], "}"}]}], ";", 
     RowBox[{"v", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"v", "\[Equal]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "temp1", ",", "temp2", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaMinus", ",", "mMinus", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "temp1", ",", "temp2", ",", "thetaPlus", ",", "mPlus", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaPlus", ",", "mPlus", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sprimed", "\[Equal]", "1"}], ",", 
       RowBox[{"C", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"{", "C", "}"}], ",", 
          RowBox[{"{", "Cprimed", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"sprimed", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mMinus"}], 
          " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus", "-", "thetaMinus"}], ")"}], ".", "mPlus"}], 
          " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", "0"}], "]"}]}]}],
      ";", 
     RowBox[{"j", " ", "=", " ", 
      RowBox[{"j", " ", "+", " ", "1"}]}], ";", "C"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNUTSstepSingleString", "[", 
   RowBox[{
   "thetaMinus_", ",", "mMinus_", ",", "thetaPlus_", ",", "mPlus_", ",", "C_",
     ",", "j_", ",", "s_", ",", "u_", ",", "\[Epsilon]_", ",", "logP_", ",", 
    "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetaMinus1", "=", "thetaMinus"}], ",", 
      RowBox[{"mMinus1", "=", "mMinus"}], ",", 
      RowBox[{"thetaPlus1", "=", "thetaPlus"}], ",", 
      RowBox[{"mPlus1", "=", "mPlus"}], ",", 
      RowBox[{"s1", "=", "s"}], ",", "temp1", ",", "temp2", ",", "Cprimed", 
      ",", "sprimed", ",", "v", ",", "C1", ",", "j1", ",", "dep"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"v", "\[Equal]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thetaMinus1", ",", "mMinus1", ",", "temp1", ",", "temp2", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaMinus1", ",", "mMinus1", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "temp1", ",", "temp2", ",", "thetaPlus1", ",", "mPlus1", ",", 
          "Cprimed", ",", "sprimed"}], "}"}], "=", 
        RowBox[{"fBuildTree", "[", 
         RowBox[{
         "thetaPlus1", ",", "mPlus", ",", "u", ",", "v", ",", "j", ",", 
          "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dep", "=", 
      RowBox[{
       RowBox[{"Depth", "@", "Cprimed"}], "-", "4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sprimed", "\[Equal]", "1"}], ",", 
       RowBox[{"C1", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "C", "}"}], ",", 
          RowBox[{"{", "Cprimed", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{"sprimed", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus1", "-", "thetaMinus1"}], ")"}], ".", 
           "mMinus1"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
         "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"thetaPlus1", "-", "thetaMinus1"}], ")"}], ".", 
           "mPlus1"}], " ", "\[GreaterEqual]", " ", "0"}], ",", "1", ",", 
         "0"}], "]"}]}]}], ";", 
     RowBox[{"j1", " ", "=", " ", 
      RowBox[{"j", " ", "+", " ", "1"}]}], ";", 
     RowBox[{"{", 
      RowBox[{
      "thetaMinus1", ",", " ", "mMinus1", ",", " ", "thetaPlus1", ",", " ", 
       "mPlus1", ",", "C1", ",", "j1", ",", "s1", ",", "u", ",", "\[Epsilon]",
        ",", "logP", ",", "\[CapitalDelta]"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7522488050062304`*^9, 3.752248829702606*^9}, {
   3.752248876538212*^9, 3.752248880225648*^9}, {3.7522489107154493`*^9, 
   3.7522489231232224`*^9}, {3.752248989231635*^9, 3.752249058417417*^9}, {
   3.752249218754447*^9, 3.752249228504674*^9}, {3.7522493394548483`*^9, 
   3.752249347614276*^9}, {3.75224943326779*^9, 3.7522494376903057`*^9}, {
   3.752249494356967*^9, 3.752249713279314*^9}, {3.7522497530902567`*^9, 
   3.752249753433041*^9}, {3.752249861990279*^9, 3.752249868983016*^9}, {
   3.752250643859624*^9, 3.752250648698619*^9}, {3.7522507211576967`*^9, 
   3.7522507449573517`*^9}, 3.752250881108919*^9, {3.752251084903672*^9, 
   3.752251178658659*^9}, {3.752251224932941*^9, 3.752251262230258*^9}, {
   3.752251311762228*^9, 3.752251334458077*^9}, {3.752251495826542*^9, 
   3.752251618510818*^9}, {3.752251705371059*^9, 3.752251719043494*^9}, {
   3.752251754390787*^9, 3.7522517789022617`*^9}, {3.752251863706205*^9, 
   3.752251885787624*^9}, {3.75225205344453*^9, 3.752252071147408*^9}, {
   3.752252120061808*^9, 3.75225214470299*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fNUTSstring", "[", 
   RowBox[{
   "theta0_", ",", "m0_", ",", "u_", ",", "\[Epsilon]_", ",", "logP_", ",", 
    "\[CapitalDelta]_"}], "]"}], ":=", 
  RowBox[{"NestWhileList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fNUTSstepSingleString", "@@", "#"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"theta0", ",", "m0", ",", "theta0", ",", "m0", ",", 
      RowBox[{"{", 
       RowBox[{"theta0", ",", "m0"}], "}"}], ",", "0", ",", "1", ",", "u", 
      ",", "\[Epsilon]", ",", "logP", ",", "\[CapitalDelta]"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "1"}], " ", "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.752249912367115*^9, 3.752249930743882*^9}, {
   3.752249978586282*^9, 3.75225018580376*^9}, {3.752250254872417*^9, 
   3.752250301497896*^9}, {3.752250485740239*^9, 3.752250537365409*^9}, 
   3.752250587102705*^9, {3.7522507805208483`*^9, 3.752250788007677*^9}, 
   3.752253441034865*^9, {3.752253604762245*^9, 3.752253611786455*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fUnravel", "[", "lTree__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Length", "@", "lTree"}], ")"}], "-", "1"}]}], ",", "lDeps", 
      ",", "lAll"}], "}"}], ",", 
    RowBox[{
     RowBox[{"lDeps", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Depth", "@", 
         RowBox[{
          RowBox[{"lTree", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"lAll", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lTree", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"lDeps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "4"}], ">", "0"}], ",", 
            RowBox[{
             RowBox[{"lDeps", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "4"}], ",", "0"}], "]"}]}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"lAll", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"lAll", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.752252346224621*^9, 3.752252453260181*^9}, {
  3.752252530673006*^9, 3.752252602699275*^9}, {3.7522528034847803`*^9, 
  3.75225286078447*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x__", "]"}], ":=", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.5", ",", "0."}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "1.5"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "x", "}"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.752253288987712*^9, 3.7522532909221277`*^9}, {
  3.752253541190378*^9, 3.752253543190077*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"fNUTSstring", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4.6", ",", "5.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", 
       RowBox[{"-", "0.2"}]}], "}"}], ",", "1", ",", "0.5", ",", "f", ",", 
     "1000"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.752253089122629*^9, 3.752253102306047*^9}, {
  3.7522531447640953`*^9, 3.7522532590653257`*^9}, {3.752253342669443*^9, 
  3.752253386311288*^9}, {3.7522534453539743`*^9, 3.752253460434148*^9}, {
  3.7522534963903637`*^9, 3.7522535022037277`*^9}, {3.752253533911055*^9, 
  3.752253571488637*^9}, {3.752253654539249*^9, 3.7522536609393177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lAnimations", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fUnravel", "[", "test", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"Length", "@", "test"}], "-", "1"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7522524547097692`*^9, 3.75225245680367*^9}, {
   3.752252607420631*^9, 3.7522527829227343`*^9}, {3.7522528646005993`*^9, 
   3.752252894408337*^9}, {3.752252936773143*^9, 3.7522529844610023`*^9}, {
   3.752253131614113*^9, 3.752253136099477*^9}, {3.752253479701385*^9, 
   3.7522534835748167`*^9}, 3.752253634901188*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {0.1, -0.2}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.1, -0.2}}}]}, {}}}, {}, {}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0, 0.2}, {-0.4, 0}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.02]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {
         0.11429117239925352`, -0.21358369044849218`}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.11429117239925352`, -0.21358369044849218`}}}]}, {}}}, {}, {}, {{}, \
{}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0.09977670043126168, -0.19932081547757538`},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0.1, 0.11429117239925352`}, {-0.21358369044849218`, -0.2}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {0.11429117239925352`, -0.21358369044849218`}, {
         0.06756560695182398, -0.16506481604519857`}, {
         0.08425952785315478, -0.18361622150785142`}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.11429117239925352`, -0.21358369044849218`}}, {{
         0.06756560695182398, -0.16506481604519857`}}, {{
         0.08425952785315478, -0.18361622150785142`}}}]}, {}}}, {}, {}, {{}, \
{}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0.06683551999170789, -0.1626388723250339},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{0.06756560695182398, 
     0.11429117239925352`}, {-0.21358369044849218`, -0.16506481604519857`}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {{{}, {}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        LineBox[{{0.1, -0.2}, {0.11429117239925352`, -0.21358369044849218`}, {
         0.06756560695182398, -0.16506481604519857`}, {
         0.08425952785315478, -0.18361622150785142`}, {-0.001842275764658563, \
-0.07869934672950697}, {0.015433010834041656`, -0.10142998063118382`}, {
         0.03287705516771683, -0.12357701008667987`}, {
         0.05033162138837696, -0.14490168056461375`}}]}}, {
       {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
        AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
          StyleBox["\<\"\[FilledCircle]\"\>",
           StripOnInput->False,
           FontSize->8.96], {0., 0.}], {{{0.1, -0.2}}, {{
         0.11429117239925352`, -0.21358369044849218`}}, {{
         0.06756560695182398, -0.16506481604519857`}}, {{
         0.08425952785315478, -0.18361622150785142`}}, \
{{-0.001842275764658563, -0.07869934672950697}}, {{
         0.015433010834041656`, -0.10142998063118382`}}, {{
         0.03287705516771683, -0.12357701008667987`}}, {{
         0.05033162138837696, -0.14490168056461375`}}}]}, {}}}, {}, {}, {{}, \
{}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{-0.001842275764658563, 
      0.11429117239925352`}, {-0.21358369044849218`, 0}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.02]}},
    Ticks->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7522534839710493`*^9, 3.7522535047725487`*^9}, {
   3.75225353516398*^9, 3.75225357279467*^9}, {3.752253635539049*^9, 
   3.7522536622007723`*^9}, 3.752253880191641*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListAnimate", "[", "lAnimations", "]"}]], "Input",
 CellChangeTimes->{{3.7522534037525177`*^9, 3.7522534064806013`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i11$$ = 5, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {
    "\"min\"" :> {$CellContext`i11$$ = 1}, 
     "\"max\"" :> {$CellContext`i11$$ = 5}}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`i11$$], 1, ""}, 1, 5, 1}}, Typeset`size$$ = 
    Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i11$3008763$$ = 0}, 
    PaneBox[
     PanelBox[
      DynamicWrapperBox[GridBox[{
         {
          ItemBox[
           ItemBox[
            TagBox[
             StyleBox[GridBox[{
                {"\<\"\"\>", 
                 AnimatorBox[Dynamic[$CellContext`i11$$], {1, 5, 1},
                  AnimationRate->Automatic,
                  AnimationRunTime->14.799132823944092`,
                  AnimationRunning->False,
                  AnimationTimeIndex->0.,
                  
                  AppearanceElements->{
                   "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons",
                     "DirectionButton"},
                  AutoAction->False,
                  DisplayAllSteps->True]}
               },
               AutoDelete->False,
               
               GridBoxAlignment->{
                "Columns" -> {Right, {Left}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "ListAnimateLabel",
              StripOnInput->False],
             {"ControlArea", Top}],
            Alignment->{Automatic, Inherited},
            StripOnInput->False],
           Background->None,
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            StyleBox[
             PaneBox[
              TagBox[
               PaneSelectorBox[{1->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.6, 5.4}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{4.6, 
                    5.4}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{0, 0},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 PlotRange->{{0, 9.2}, {0, 10.8}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.02], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 2->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 
                    5.496821056031902}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.5524473649676, 5.3951589471984045`},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.553178943968098, 4.6}, {5.4, 
                  5.496821056031902}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 3->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}, {4.653178943968098, 
                    5.296821056031902}, {4.712079466765697, 
                    5.188745393595286}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 5.496821056031902}}, {{
                    4.653178943968098, 5.296821056031902}}, {{
                    4.712079466765697, 
                    5.188745393595286}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.550696123299385, 5.1733416104734555`},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.553178943968098, 4.712079466765697}, {
                  5.188745393595286, 5.496821056031902}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 4->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}, {4.653178943968098, 
                    5.296821056031902}, {4.712079466765697, 
                    5.188745393595286}, {4.7758743087669355`, 
                    5.077461275707109}, {4.843558964142576, 
                    4.964832778669063}, {4.910670151304915, 
                    4.8531847642320685`}, {4.979345561435977, 
                    4.744107578776669}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 5.496821056031902}}, {{
                    4.653178943968098, 5.296821056031902}}, {{
                    4.712079466765697, 5.188745393595286}}, {{
                    4.7758743087669355`, 5.077461275707109}}, {{
                    4.843558964142576, 4.964832778669063}}, {{
                    4.910670151304915, 4.8531847642320685`}}, {{
                    4.979345561435977, 
                    4.744107578776669}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.546520090570162, 4.706471904913907},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.553178943968098, 4.979345561435977}, {
                  4.744107578776669, 5.496821056031902}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}], 5->
                GraphicsBox[{{}, {{{}, {}, 
                    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
                    0.012833333333333334`], AbsoluteThickness[1.6], 
                    LineBox[{{4.6, 5.4}, {4.553178943968098, 
                    5.496821056031902}, {4.653178943968098, 
                    5.296821056031902}, {4.712079466765697, 
                    5.188745393595286}, {4.7758743087669355`, 
                    5.077461275707109}, {4.843558964142576, 
                    4.964832778669063}, {4.910670151304915, 
                    4.8531847642320685`}, {4.979345561435977, 
                    4.744107578776669}, {4.421046683890428, 
                    5.891732900343218}, {4.425038270906425, 
                    5.851039758407249}, {4.424079067676896, 
                    5.9216073705809285`}, {4.433981609079613, 
                    5.940487991592413}, {4.436183240147287, 
                    5.799758411426674}, {4.4545742851104455`, 
                    5.738198707324797}, {4.480249155005121, 
                    5.666780813551911}, {4.51316678268937, 
                    5.586071290957647}}]}}, {
                    {RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsolutePointSize[6], AbsoluteThickness[1.6], 
                    GeometricTransformationBox[InsetBox[
                    StyleBox["\<\"\[FilledCircle]\"\>",
                    StripOnInput->False,
                    FontSize->8.96], {0., 0.}], {{{4.6, 5.4}}, {{
                    4.553178943968098, 5.496821056031902}}, {{
                    4.653178943968098, 5.296821056031902}}, {{
                    4.712079466765697, 5.188745393595286}}, {{
                    4.7758743087669355`, 5.077461275707109}}, {{
                    4.843558964142576, 4.964832778669063}}, {{
                    4.910670151304915, 4.8531847642320685`}}, {{
                    4.979345561435977, 4.744107578776669}}, {{
                    4.421046683890428, 5.891732900343218}}, {{
                    4.425038270906425, 5.851039758407249}}, {{
                    4.424079067676896, 5.9216073705809285`}}, {{
                    4.433981609079613, 5.940487991592413}}, {{
                    4.436183240147287, 5.799758411426674}}, {{
                    4.4545742851104455`, 5.738198707324797}}, {{
                    4.480249155005121, 5.666780813551911}}, {{
                    4.51316678268937, 
                    5.586071290957647}}}]}, {}}}, {}, {}, {{}, {}}},
                 AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
                 Axes->{True, True},
                 AxesLabel->{None, None},
                 AxesOrigin->{4.412323263928779, 4.684288558135882},
                 DisplayFunction->Identity,
                 Frame->{{False, False}, {False, False}},
                 FrameLabel->{{None, None}, {None, None}},
                 FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
                 
                 GridLines->{None, None},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 ImagePadding->All,
                 
                 Method->{
                  "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 1, 
                    2][#]& )[
                    Part[#, 1]], 
                    (
                    Part[{{Identity, Identity}, {Identity, Identity}}, 2, 
                    2][#]& )[
                    Part[#, 2]]}& )}},
                 
                 PlotRange->{{4.421046683890428, 4.979345561435977}, {
                  4.744107578776669, 5.940487991592413}},
                 PlotRangeClipping->True,
                 PlotRangePadding->{{
                    Scaled[0.02], 
                    Scaled[0.02]}, {
                    Scaled[0.05], 
                    Scaled[0.05]}},
                 Ticks->{Automatic, Automatic}]}, Dynamic[$CellContext`i11$$],
                
                Alignment->Automatic,
                ImageSize->All,
                TransitionDirection->Horizontal,
                TransitionDuration->0.5,
                TransitionEffect->Automatic],
               Identity,
               Editable->True,
               Selectable->True],
              ImageMargins->10],
             Deployed->False,
             StripOnInput->False,
             ScriptLevel->0,
             GraphicsBoxOptions->{PreserveImageOptions->True},
             Graphics3DBoxOptions->{PreserveImageOptions->True}],
            Identity,
            Editable->False,
            Selectable->False],
           Alignment->{Left, Center},
           Background->GrayLevel[1],
           Frame->1,
           FrameStyle->GrayLevel[0, 0.2],
           ItemSize->Automatic,
           StripOnInput->False]}
        },
        AutoDelete->False,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Top}}, 
          "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
          "RowsIndexed" -> {}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.7], {
             Offset[0.5599999999999999]}, 
            Offset[0.7]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.4], {
             Offset[0.8]}, 
            Offset[0.4]}, "RowsIndexed" -> {}}], If[
        And[
         CurrentValue["NotebookSelected"], 
         CurrentValue["SelectionOver"]], 
        Manipulate`Dump`ReadControllerState[
         Map[Manipulate`Dump`updateOneVar[#, 
           CurrentValue["PreviousFormatTime"], 
           CurrentValue["CurrentFormatTime"]]& , {
           
           Manipulate`Dump`controllerLink[{$CellContext`i11$$, \
$CellContext`i11$3008763$$}, "X1", 
            If["DefaultAbsolute", True, "JB1"], False, {1, 5, 1}, 5, 1.]}], 
         CurrentValue[{
          "ControllerData", {
           "Gamepad", "Joystick", "Multi-Axis Controller"}}], {}]],
       ImageSizeCache->{393., {144.384033203125, 150.115966796875}}],
      DefaultBaseStyle->{},
      FrameMargins->{{5, 5}, {5, 5}}],
     BaselinePosition->Automatic,
     ImageMargins->0],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "ListAnimate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.75225340683633*^9, {3.752253447442727*^9, 3.7522535084339027`*^9}, {
   3.752253547005416*^9, 3.7522535746862307`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1406, 1008},
WindowMargins->{{Automatic, 331}, {112, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 289, 6, 32, "Input"],
Cell[850, 28, 13699, 361, 663, "Input"],
Cell[CellGroupData[{
Cell[14574, 393, 390, 10, 32, "Input"],
Cell[14967, 405, 869, 14, 24, "Message"],
Cell[15839, 421, 697, 12, 24, "Message"],
Cell[16539, 435, 869, 14, 24, "Message"],
Cell[17411, 451, 875, 14, 24, "Message"],
Cell[18289, 467, 342, 7, 24, "Message"],
Cell[18634, 476, 1223, 20, 30, "Message"],
Cell[19860, 498, 411, 8, 24, "Message"],
Cell[20274, 508, 1181, 19, 30, "Message"],
Cell[21458, 529, 732, 12, 24, "Message"],
Cell[22193, 543, 1226, 20, 30, "Message"],
Cell[23422, 565, 351, 7, 24, "Message"],
Cell[23776, 574, 412, 8, 24, "Message"],
Cell[24191, 584, 710, 12, 24, "Message"],
Cell[24904, 598, 347, 7, 24, "Message"],
Cell[25254, 607, 358, 7, 24, "Message"],
Cell[25615, 616, 340, 7, 24, "Message"],
Cell[25958, 625, 327, 7, 24, "Message"],
Cell[26288, 634, 599, 10, 24, "Message"],
Cell[26890, 646, 329, 7, 24, "Message"],
Cell[27222, 655, 329, 7, 24, "Message"],
Cell[27554, 664, 349, 7, 24, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27940, 676, 265, 6, 32, "Input"],
Cell[28208, 684, 2858, 42, 59, "Message"],
Cell[31069, 728, 883, 15, 42, "Message"],
Cell[31955, 745, 702, 12, 24, "Message"],
Cell[32660, 759, 918, 15, 42, "Message"],
Cell[33581, 776, 737, 12, 24, "Message"],
Cell[34321, 790, 896, 15, 42, "Message"],
Cell[35220, 807, 342, 7, 24, "Message"],
Cell[35565, 816, 715, 12, 24, "Message"],
Cell[36283, 830, 347, 7, 24, "Message"],
Cell[36633, 839, 2863, 42, 59, "Message"],
Cell[39499, 883, 2864, 42, 59, "Message"],
Cell[42366, 927, 340, 7, 24, "Message"],
Cell[42709, 936, 2863, 42, 59, "Message"],
Cell[45575, 980, 15597, 429, 327, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61209, 1414, 103, 1, 64, "Section"],
Cell[61315, 1417, 8181, 204, 453, "Input"],
Cell[69499, 1623, 1066, 24, 32, "Input"],
Cell[70568, 1649, 2052, 59, 75, "Input"],
Cell[72623, 1710, 697, 20, 32, "Input"],
Cell[73323, 1732, 688, 15, 32, "Input"],
Cell[CellGroupData[{
Cell[74036, 1751, 1017, 24, 32, "Input"],
Cell[75056, 1777, 8361, 182, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83454, 1964, 144, 2, 32, "Input"],
Cell[83601, 1968, 20411, 438, 325, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

